import{e as b,m as _,f as v,g as t,h as V,w as C,n as I,i as d,v as u,t as f,j as N,k as S,r as U,u as B,o as y,l as j}from"./vendor.Da2sdW28.js";import{s as q,a as R}from"./index.DuRPLurf.js";import"./index.BYIGvkoh.js";const T={class:"min-h-screen bg-gray-50 flex items-center justify-center px-4"},A={class:"w-full max-w-md"},D={class:"bg-white rounded-2xl p-6 shadow-lg"},M={class:"mb-4"},$={class:"mb-4"},E={class:"mb-4"},z={key:0,class:"mb-4"},F={class:"flex gap-2"},G=["disabled"],H={class:"mb-6"},J=["disabled"],K={class:"mt-6 text-center"},W={__name:"Register",setup(L){const g=B(),s=b({username:"",phone:"",code:"",password:"",nickname:""}),i=b(!1),m=b(!1),a=b(0);let l=null;const x=()=>{a.value=60,l=setInterval(()=>{a.value-=1,a.value<=0&&(clearInterval(l),l=null)},1e3)};_(()=>{l&&(clearInterval(l),l=null)});const w=async()=>{var n,e,r,o;if(!s.value.phone){alert("请先输入手机号");return}i.value=!0;try{const c=(e=(n=(await q.send(s.value.phone,"user_register")).data)==null?void 0:n.data)==null?void 0:e.debug_code;alert(c?`验证码已发送（开发模式）：${c}`:"验证码已发送"),x()}catch(p){alert(((o=(r=p.response)==null?void 0:r.data)==null?void 0:o.error)||"发送失败，请重试")}finally{i.value=!1}},k=async()=>{var n,e;m.value=!0;try{const r=await R.register(s.value),{token:o,user_id:p,nickname:c,username:h}=r.data.data;localStorage.setItem("userToken",o),localStorage.setItem("userId",p),localStorage.setItem("userName",c||h),g.push("/user/cards")}catch(r){alert(((e=(n=r.response)==null?void 0:n.data)==null?void 0:e.error)||"注册失败，请重试")}finally{m.value=!1}};return(n,e)=>{const r=U("router-link");return y(),v("div",T,[t("div",A,[e[12]||(e[12]=V('<div class="text-center mb-8"><div class="flex items-center justify-center gap-2 mb-2"><span class="text-primary font-bold text-3xl">卡包</span><span class="text-gray-400 text-sm">kabao.app</span></div><p class="text-gray-500">用户端注册</p></div>',1)),t("div",D,[e[11]||(e[11]=t("h2",{class:"text-xl font-bold text-gray-800 mb-6"},"创建账号",-1)),t("form",{onSubmit:C(k,["prevent"])},[t("div",M,[e[5]||(e[5]=t("label",{class:"block text-gray-700 text-sm font-medium mb-2"},"用户名",-1)),d(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.value.username=o),type:"text",placeholder:"请输入用户名",class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:border-primary",required:""},null,512),[[u,s.value.username]])]),t("div",$,[e[6]||(e[6]=t("label",{class:"block text-gray-700 text-sm font-medium mb-2"},"密码",-1)),d(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.value.password=o),type:"password",placeholder:"请输入密码（至少6位）",class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:border-primary",required:"",minlength:"6"},null,512),[[u,s.value.password]])]),t("div",E,[e[7]||(e[7]=t("label",{class:"block text-gray-700 text-sm font-medium mb-2"},"手机号（可选）",-1)),d(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.value.phone=o),type:"tel",placeholder:"请输入手机号",class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:border-primary"},null,512),[[u,s.value.phone]])]),s.value.phone?(y(),v("div",z,[e[8]||(e[8]=t("label",{class:"block text-gray-700 text-sm font-medium mb-2"},"验证码",-1)),t("div",F,[d(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>s.value.code=o),type:"text",placeholder:"请输入验证码",class:"flex-1 px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:border-primary",required:""},null,512),[[u,s.value.code]]),t("button",{type:"button",disabled:i.value||a.value>0,class:"px-3 py-3 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors disabled:opacity-50 whitespace-nowrap shrink-0",onClick:w},f(a.value>0?`${a.value}s`:i.value?"发送中...":"发送验证码"),9,G)])])):I("",!0),t("div",H,[e[9]||(e[9]=t("label",{class:"block text-gray-700 text-sm font-medium mb-2"},"昵称（可选）",-1)),d(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>s.value.nickname=o),type:"text",placeholder:"请输入昵称",class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:border-primary"},null,512),[[u,s.value.nickname]])]),t("button",{type:"submit",disabled:m.value,class:"w-full py-3 bg-primary text-white rounded-lg font-medium hover:bg-primary-dark transition-colors disabled:opacity-50"},f(m.value?"注册中...":"注册并登录"),9,J)],32),t("div",K,[N(r,{to:"/login",class:"text-sm text-primary hover:underline"},{default:S(()=>[...e[10]||(e[10]=[j(" 返回登录 ",-1)])]),_:1})])])])])}}};export{W as default};
