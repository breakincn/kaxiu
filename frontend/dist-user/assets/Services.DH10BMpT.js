import{e as _,s as x,f as l,g as s,n as f,i as o,L as d,v as m,t as q,u as w,o as i}from"./vendor.Da2sdW28.js";import{m as b}from"./index.DuRPLurf.js";import"./index.BYIGvkoh.js";const k={class:"min-h-screen bg-gray-50"},h={class:"px-4 py-6"},V={key:0,class:"text-gray-400 text-center py-10"},C={key:1,class:"space-y-4"},U={class:"bg-white rounded-xl shadow-sm overflow-hidden"},M={class:"px-4 py-4 border-b border-gray-100 flex items-center justify-between"},j={class:"px-4 py-4 border-b border-gray-100 flex items-center justify-between"},B={key:0,class:"px-4 py-4 border-b border-gray-100 space-y-3"},S={class:"px-4 py-4 flex items-center justify-between"},A={key:1,class:"px-4 py-4 flex items-center justify-between border-t border-gray-100"},D={class:"bg-white rounded-xl shadow-sm p-4"},N=["disabled"],L={__name:"Services",setup(R){const p=w(),v=_(!0),n=_(!1),t=_({support_appointment:!1,support_queue:!1,queue_prefix:"",queue_start_no:1,support_direct_sale:!1,support_customer_service:!1,avg_service_minutes:30}),y=()=>{if(window.history.length>1){p.back(),setTimeout(()=>{p.currentRoute.value.path==="/merchant/services"&&p.push("/merchant/settings")},80);return}p.push("/merchant/settings")},c=async()=>{var a,e;v.value=!0;try{const u=(await b.getCurrentMerchant()).data.data||{};t.value={support_appointment:!!u.support_appointment,support_queue:!!u.support_queue,queue_prefix:u.queue_prefix||"",queue_start_no:u.queue_start_no||1,support_direct_sale:!!u.support_direct_sale,support_customer_service:!!u.support_customer_service,avg_service_minutes:u.avg_service_minutes||30}}catch(r){console.error("加载商户服务配置失败",r),alert(((e=(a=r.response)==null?void 0:a.data)==null?void 0:e.error)||"加载失败")}finally{v.value=!1}},g=async()=>{var a,e;if(!n.value){if(t.value.support_queue&&(!t.value.queue_start_no||t.value.queue_start_no<1)){alert("叫号起始号码必须大于等于1");return}if(!t.value.avg_service_minutes||t.value.avg_service_minutes<1){alert("平均服务时长必须大于等于1");return}n.value=!0;try{await b.updateCurrentMerchantServices({support_appointment:t.value.support_appointment,support_queue:t.value.support_queue,queue_prefix:t.value.queue_prefix,queue_start_no:t.value.queue_start_no,support_direct_sale:t.value.support_direct_sale,support_customer_service:t.value.support_customer_service,avg_service_minutes:t.value.avg_service_minutes}),alert("保存成功"),await c()}catch(r){alert(((e=(a=r.response)==null?void 0:a.data)==null?void 0:e.error)||"保存失败")}finally{n.value=!1}}};return x(()=>{c()}),(a,e)=>(i(),l("div",k,[s("header",{class:"bg-white px-4 py-3 flex items-center gap-3 border-b sticky top-0 z-10"},[s("button",{onClick:y,class:"p-1"},[...e[7]||(e[7]=[s("svg",{class:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),e[8]||(e[8]=s("span",{class:"font-medium text-gray-800"},"开启服务",-1))]),s("div",h,[v.value?(i(),l("div",V,"加载中...")):(i(),l("div",C,[s("div",U,[s("div",M,[e[9]||(e[9]=s("div",{class:"text-gray-800 font-medium"},"开启预约",-1)),o(s("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=r=>t.value.support_appointment=r)},null,512),[[d,t.value.support_appointment]])]),s("div",j,[e[10]||(e[10]=s("div",{class:"text-gray-800 font-medium"},"开启叫号",-1)),o(s("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=r=>t.value.support_queue=r)},null,512),[[d,t.value.support_queue]])]),t.value.support_queue?(i(),l("div",B,[s("div",null,[e[11]||(e[11]=s("div",{class:"text-sm font-medium text-gray-700 mb-2"},"叫号前缀",-1)),o(s("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>t.value.queue_prefix=r),type:"text",placeholder:"如 A",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[m,t.value.queue_prefix]])]),s("div",null,[e[12]||(e[12]=s("div",{class:"text-sm font-medium text-gray-700 mb-2"},"起始号码",-1)),o(s("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>t.value.queue_start_no=r),type:"number",min:"1",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[m,t.value.queue_start_no,void 0,{number:!0}]])])])):f("",!0),s("div",S,[e[13]||(e[13]=s("div",{class:"text-gray-800 font-medium"},"开启直购售卡",-1)),o(s("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=r=>t.value.support_direct_sale=r)},null,512),[[d,t.value.support_direct_sale]])]),t.value.support_direct_sale?(i(),l("div",A,[e[14]||(e[14]=s("div",{class:"text-gray-800 font-medium"},"设置客服",-1)),o(s("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=r=>t.value.support_customer_service=r)},null,512),[[d,t.value.support_customer_service]])])):f("",!0)]),s("div",D,[e[15]||(e[15]=s("div",{class:"text-sm font-medium text-gray-700 mb-2"},"平均服务时长（分钟）",-1)),o(s("input",{"onUpdate:modelValue":e[6]||(e[6]=r=>t.value.avg_service_minutes=r),type:"number",min:"1",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[m,t.value.avg_service_minutes,void 0,{number:!0}]])]),s("button",{onClick:g,disabled:n.value,class:"w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 font-medium disabled:bg-gray-300 disabled:cursor-not-allowed"},q(n.value?"保存中...":"保存"),9,N)]))])]))}};export{L as default};
